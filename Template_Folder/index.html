<!DOCTYPE HTML>
<html>
<head>
    <title>Full-Stack Order Entry Application</title>
</head>
<body>
    <div>
        <h1>Create Sales Order</h1>
        <!-- <form action="/order"> -->
        <form id = "SalesOrderForm" method="POST">
            <div>
                <label for = "CustomerName">Customer Name</label>
                <input type="text" id = "CustomerName" name = "CustomerName" required><br>
            </div>
            <label for ="LineItemsOrder">Line Items</label><br>
            <div id = "LineItemsList">
                <div>
                    <input type = "text" id = "LineItemName_0" name = "LineItemName" required placeholder = "Product Name">
                    <input type = "number" id = "LineItemQuantity_0" name = "LineItemQuantity" required placeholder = "Quantity">
                </div>
            </div>
            <div>
                <button type="button" id = "addLineItemAction">Add Line Item</button>
                <button type="submit">Submit sales order</button>
        </form>

        <div id = "ConfirmationBoard"></div>

    </div>
    <script>
        document.addEventListener('DOMContentLoaded', () => {{
            const SalesOrderForm = document.getElementById("SalesOrderForm");
            const LineItemsList = document.getElementById("LineItemsList");
            const addLineItemAction = document.getElementById("addLineItemAction");
            const ConfirmationBoard = document.getElementById("ConfirmationBoard");

            let LineItemsCounter = 0;

            const addLineItem = () => {{
                const LineItemsList = document.getElementById("LineItemsList");
                LineItemsCounter++
                const newLineItem = document.createElement('div');
                newLineItem.innerHTML = `
                    <div>
                    <input type = "text" id = "LineItemName_${{LineItemsCounter}}" name = "LineItemName" required placeholder = "Product Name">
                    <input type = "number" id = "LineItemQuantity_${{LineItemsCounter}}" name = "LineItemQuantity" required placeholder = "Quantity">
                    </div>
                `;
                LineItemsList.appendChild(newLineItem);
            }};
            addLineItemAction.addEventListener('click', addLineItem);

            SalesOrderForm.addEventListener('submit', async(event) => {{
                
                event.preventDefault(); 

                const formData = new FormData(SalesOrderForm)

                try {{
                    const response = await fetch("/order", {
                        method: 'POST',
                        body: formData
                    });
                }} catch (error) {{
                    console.error('Error in submitting sales order: ', error);
                }}

            }});
        }});
    </script>
</body>
</html>